# NYCU 選課助手 v3.0.2

> 強大的 NYCU 選課工具，支援 AI 智能搜尋、自動關鍵字學習、課表製作、書籤管理、詳細資訊查詢

**Chrome 線上應用程式商店**：https://chromewebstore.google.com/detail/nycu-%E8%AA%B2%E7%A8%8B%E6%90%9C%E5%B0%8B%E5%8A%A9%E6%89%8B/miaebenciplpjnmbfnhibkkgfeiciijn

## ✨ 主要功能

### 🤖 AI 智能搜尋（NEW!）
- **自然語言查詢**：使用 Google Gemini 2.5 Flash 理解你的問題
  - 例如：「週一下午有哪些資工系的課」
  - 例如：「資料結構相關的課程有哪些」
  - 例如：「王禹超老師教的微積分」
- **智能理解**：AI 自動分析查詢意圖並找到最相關的課程
- **主動關鍵字學習**：啟動時自動為所有課程提取關鍵字，越用越聰明
  - 自動從課程綱要提取中英文關鍵字
  - 支援暫停/繼續控制
  - 實時顯示學習進度
- **API 金鑰設定**：需自行申請 [Gemini API 金鑰](https://ai.google.dev/)（免費額度充足）
- **即時回應**：快速返回搜尋結果

### 📅 課表製作與匯出（NEW!）
- **視覺化課表**：週一到週日，早上到晚上完整時段
- **拖放式編輯**：輕鬆安排課程
- **衝堂檢測**：自動警告時間衝突
- **PNG 圖片匯出**：📸 高品質截圖，適合分享
- **課表儲存**：自動儲存在瀏覽器本地
- **顏色自訂**：為不同課程設定顏色標記

### 🔍 傳統搜尋
- **多條件搜尋**：支援課程名稱、代碼、系所、學院、教師、時間、教室
- **智能簡稱識別**：輸入「邏設」找到「邏輯設計」，輸入「線代」找到「線性代數」
- **多關鍵字搜尋**：用空格分隔多個條件（例如：「資工 演算法」、「邏設 一年級」）
- **即時結果**：快速顯示符合的課程

### ⭐ 書籤管理
- **收藏課程**：點擊星號圖示加入常用課程到書籤
- **快速存取**：專屬書籤分頁，快速查看收藏的課程
- **批次管理**：一鍵清空所有書籤

### 📋 詳細資訊查詢
- **完整課程資訊**：點擊「查看完整資訊」進入專屬詳細頁面
- **官方 API 整合**：直接從 NYCU timetable 官方 API 獲取最新資料
- **豐富內容**：
  - 📍 時間地點、學分、必選修
  - 👨‍🏫 授課教師
  - 📚 先修科目或先備能力
  - 🎯 課程概述與目標
  - 📖 教科書
  - 📊 評量方式（配分細節）
  - 🎓 教學方法
  - 👥 師生晤談時間
  - 📧 聯絡方式

### 📂 選課路徑顯示
- **完整路徑**：顯示所有可用的選課途徑
- **結構化資訊**：類型 / 類別 / 學院 / 系所 / 年級
- **多路徑支援**：一個課程可能有多個選課路徑，全部列出

### 📄 課程綱要連結
- **一鍵開啟**：直接在新分頁開啟官方課程綱要頁面
- **完整資訊**：查看官方的完整課程綱要

### 💾 本地資料儲存
- **智能快取**：課程資料本地儲存 7 天
- **自動更新**：資料過期後自動提示更新
- **快速查詢**：無需重複載入，搜尋更快速

## 📦 安裝方式

### 從 Chrome 線上應用程式商店安裝（推薦）

1. 訪問 [NYCU 課程搜尋助手](https://chromewebstore.google.com/detail/nycu-%E8%AA%B2%E7%A8%8B%E6%90%9C%E5%B0%8B%E5%8A%A9%E6%89%8B/miaebenciplpjnmbfnhibkkgfeiciijn)
2. 點擊「加到 Chrome」
3. 確認安裝
4. 完成！

### 開發者模式安裝

1. 下載或 clone 此專案
2. 開啟 Chrome 瀏覽器，輸入 `chrome://extensions/`
3. 開啟右上角的「開發人員模式」
4. 點擊「載入未封裝項目」
5. 選擇 `course_registration` 資料夾
6. 完成安裝！

## 🚀 使用指南

### 第一次使用

1. **載入課程資料**
   - 訪問 [NYCU 課程時間表](https://timetable.nycu.edu.tw/)
   - 擴充功能會自動抓取課程資料（約需 5 分鐘）
   - 抓取完成後會顯示通知

2. **設定 AI 功能（選配）**
   - 點擊瀏覽器工具列的擴充功能圖示
   - 切換到「⚙️ 設定」分頁
   - 勾選「啟用 AI 智能搜尋」
   - 前往 [Google AI Studio](https://ai.google.dev/) 申請免費 API 金鑰
   - 將 API 金鑰貼到設定中並儲存

3. **開始搜尋**
   - 在搜尋框輸入關鍵字
   - 或使用 AI 搜尋輸入自然語言問題
   - 查看搜尋結果

### AI 智能搜尋

#### 啟用 AI 搜尋
1. 確認已在設定中啟用 AI 功能並輸入 Gemini API 金鑰
2. 在搜尋框輸入自然語言問題
3. 點擊「🤖 AI 搜尋」按鈕

#### AI 搜尋範例
```
週一下午有哪些資工系的課
找資料結構相關的課程
王禹超老師教的微積分在哪個時段
有哪些3學分的通識課
週二和週四都有課的課程
```

### 課表製作

#### 建立課表
1. 切換到「📅 課表」分頁
2. 從搜尋結果或書籤中找到想加入的課程
3. 點擊「➕ 加入課表」按鈕
4. 課程會自動出現在對應的時間格子中

#### 管理課表
- **移除課程**：點擊課表中的課程卡片，選擇「移除」
- **查看衝堂**：系統會自動標記時間衝突的課程（紅色警告）
- **顏色標記**：點擊課程可自訂顏色

#### 匯出課表
1. 點擊「📥 匯出 PNG」按鈕
2. 系統會自動生成高品質課表截圖
3. 圖片會自動下載（適合分享或列印）

### 傳統搜尋技巧

#### 基本搜尋
```
微積分          # 搜尋課程名稱
DCP1192         # 搜尋課程代碼
王禹超          # 搜尋授課教師
資工系          # 搜尋開課系所（支援簡稱）
電機學院        # 搜尋學院
M               # 搜尋星期一課程（使用星期代碼）
M3              # 搜尋星期一第3節
T56             # 搜尋星期二第5-6節
R34             # 搜尋星期四第3-4節
EC015           # 搜尋教室
```

**時間代碼說明**：
- 星期：M(一) T(二) W(三) R(四) F(五) S(六) U(日)
- 節次：1-9(上午8點~下午6點20) a-d(晚上6點30~10點20)

#### 簡稱搜尋
```
邏設            # 找到「邏輯設計」
線代            # 找到「線性代數」
計組            # 找到「計算機組織」
資訊工程        # 找到「資訊工程學系」
```

#### 多條件搜尋
```
邏設 資工        # 找到資工系的邏輯設計課程
M56 資工         # 找到資工系週一5-6節的課程
資工 演算法      # 找到資工系的演算法課程
微積分 M         # 找到週一上課的微積分
微積分 王禹超    # 找到王禹超老師的微積分
```

### 書籤功能

1. **加入書籤**
   - 在搜尋結果中找到想收藏的課程
   - 點擊課程卡片右上角的 ☆ 星號
   - 星號變成 ⭐ 表示已加入書籤

2. **查看書籤**
   - 切換到「⭐ 我的書籤」分頁
   - 查看所有收藏的課程

3. **移除書籤**
   - 點擊已加入書籤的 ⭐ 星號
   - 或在書籤頁面點擊「🗑️ 清空所有書籤」

### 查看詳細資訊

1. 在搜尋結果或書籤中找到課程
2. 點擊課程卡片底部的「查看完整資訊」按鈕
3. 進入詳細資訊頁面，查看：
   - 選課路徑
   - 課程詳細資訊（評分方式、教學目標等）
4. 點擊「📄 開啟課程綱要」可在新分頁查看官方課程綱要
5. 點擊「← 返回」回到列表頁面

## 📁 專案結構

```
course_registration/
├── manifest.json         # Chrome Extension 配置檔（Manifest V3）
├── popup.html            # 側邊欄介面（含課表編輯器）
├── popup.js              # 主要邏輯（搜尋、AI、書籤、課表）
├── content.js            # 內容腳本（資料抓取）
├── background.js         # 背景腳本
├── styles.css            # 樣式檔（大幅擴充）
├── html2canvas.min.js    # 課表截圖函式庫
├── 128.png               # 擴充功能圖示
├── README.md             # 說明文件
├── INSTALL.md            # 安裝指南
└── STORE_DESCRIPTION.txt # Chrome Web Store 商店描述
```

## 🔧 技術架構

### 前端技術
- **HTML/CSS/JavaScript**：原生技術，無框架依賴
- **Chrome Extension Manifest V3**：最新擴充功能規範
- **Chrome Storage API**：本地資料儲存
- **Fetch API**：與官方 API 和 Gemini AI 通訊
- **html2canvas**：課表截圖與圖片匯出

### 資料來源
- **NYCU 課程時間表 API**
  - Base URL: `https://timetable.nycu.edu.tw/`
  - Endpoints:
    - `get_acysem` - 學期資訊
    - `get_college` - 學院列表
    - `get_dep` - 系所列表
    - `get_cos_list` - 課程列表
    - `getCrsOutlineBase` - 課程基本資訊
    - `getCrsOutlineDescription` - 課程詳細描述

- **Google Gemini AI API**
  - Base URL: `https://generativelanguage.googleapis.com/`
  - Model: `gemini-2.5-flash`
  - 用途：自然語言課程搜尋

### 核心功能實作
1. **智能搜尋**：
   - 多關鍵字分割與匹配
   - 簡稱識別演算法（按順序匹配字元）
   - 多欄位搜尋（名稱、代碼、教師、系所等）

2. **資料快取**：
   - Chrome Storage API 本地儲存
   - 7 天有效期限，自動提示更新
   - 時間戳記管理

3. **書籤系統**：
   - 唯一鍵值識別課程
   - 持久化儲存
   - 即時同步更新

4. **詳細頁面**：
   - 頁面切換機制
   - API 並行請求
   - 結果快取優化

## 💡 使用技巧

### 快速鍵
- **Enter**：執行搜尋
- **Ctrl + Shift + L**（開發模式）：載入示範資料

### 資料管理
- 資料會在 7 天後自動過期
- 點擊「重新載入課程資料（約需 5 分鐘）」可手動更新
- 擴充功能會顯示資料狀態（新鮮/有效/過期）

### 最佳實踐
1. 第一次使用時確保網路穩定，讓資料完整載入
2. 善用簡稱搜尋，更快找到課程
3. 多個條件用空格分隔，精確搜尋
4. 收藏常用課程到書籤，快速存取

## 🐛 除錯方式

### 檢查資料載入狀態
1. 訪問 https://timetable.nycu.edu.tw/
2. 按 F12 開啟開發者工具
3. 切換到 Console 分頁
4. 查看載入進度訊息

### 檢查儲存資料
1. 按 F12 開啟開發者工具
2. Application → Storage → Extension Storage
3. 查看 `courseData` 和 `lastUpdate`

### 常見問題

**Q: 為什麼搜尋顯示「尚未載入課程資料」？**
- A: 需先訪問 https://timetable.nycu.edu.tw/ 讓擴充功能抓取資料

**Q: 資料載入很慢？**
- A: 第一次載入需要幾分鐘，請耐心等待。資料會快取，之後搜尋會很快。

**Q: 如何更新課程資料？**
- A: 點擊「重新載入課程資料」按鈕，或等待 7 天後自動提示更新

**Q: 書籤會消失嗎？**
- A: 不會，書籤資料會永久儲存在瀏覽器本地，除非手動清空

## 🔄 更新日誌

### v3.0.2 (2025-11-24)
- ✨ **主動關鍵字學習**
  - 啟動時自動為所有課程提取關鍵字（後台執行）
  - 實時進度顯示（百分比 + 成功/失敗統計）
  - 支援暫停/繼續控制
  - 批次處理優化（10門課/批次，1秒延遲）
  - 與 AI 搜尋智能協調（搜尋時自動暫停學習）
- 🔧 **性能優化**
  - 添加 API 請求超時機制（15秒）
  - 添加 AI 提取超時機制（20秒）
  - 改進錯誤處理和重試邏輯
  - 詳細錯誤日誌輸出
- 🎨 **UI 改進**
  - 簡化進度條設計（頂部低調顯示）
  - 改進進度資訊呈現

### v3.0.1 (2025-11-24)
- 🔧 **權限清理**
  - 移除未使用的 Ollama 和 OpenAI 權限
  - 僅保留 Gemini API 權限
  - 減少擴充功能權限需求，提升安全性

### v3.0.0 (2025-11-24) - 重大更新
- 🤖 **AI 智能搜尋**
  - 整合 Google Gemini 2.5 Flash
  - 自然語言查詢功能
  - 智能理解多條件組合
- 📅 **課表製作與匯出**
  - 視覺化課表編輯器
  - PNG 圖片匯出（html2canvas 高品質截圖）
  - 衝堂自動檢測
  - 課表自動儲存
  - 課程顏色自訂
- 📖 **擴充功能更名**
  - 從「NYCU 課程搜尋助手」更名為「NYCU 選課助手」
- 🎨 **全新 UI/UX**
  - 重新設計的主介面
  - 響應式佈局優化
  - 改進的課程卡片設計
- 🐛 **Bug 修復**
  - 修復時間代碼解析問題
  - 修復教室/校區資訊提取
  - 修正特殊時間搜尋問題
- 📦 **新增依賴**
  - html2canvas.min.js（課表截圖）
- 🔧 **技術改進**
  - 新增 Gemini API 整合
  - 優化資料儲存結構
  - 改進錯誤處理機制

### v2.0 (2025-01-17)
- ✨ 新增書籤系統
- ✨ 新增詳細資訊頁面
- ✨ 整合官方 API 獲取完整課程資訊
- ✨ 顯示選課路徑完整列表
- ✨ 添加課程綱要快速連結
- 🎨 全新 UI 設計
- 🎨 新增「查看完整資訊」等寬按鈕
- 🎨 優化視覺效果與互動體驗
- 📝 延長資料有效期至 7 天

### v1.0 (2025-01-14)
- 🎉 首次發布
- 🔍 基本搜尋功能
- 💾 本地資料儲存
- 📊 顯示課程基本資訊

## 📄 授權

MIT License

## 🤝 貢獻

歡迎提交 Issue 和 Pull Request！

## 📧 聯絡方式

如有問題或建議，歡迎透過 GitHub Issues 聯繫。
